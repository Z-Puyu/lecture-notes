\documentclass[math]{amznotes}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{etoolbox}

\graphicspath{ {./images/} }
\geometry{
    a4paper,
    headheight = 1.5cm
}

\patchcmd{\chapter}{\thispagestyle{plain}}
{\thispagestyle{fancy}}{}{}

\theoremstyle{remark}
\newtheorem*{claim}{Claim}
\newtheorem*{remark}{Remark}
\newtheorem{case}{Case}

\newcommand{\map}[3]{#1: #2 \rightarrow #3} % Mapping
\newcommand{\image}[2]{#2\left[#1\right]} % Image
\newcommand{\preimage}[2]{#2\left[#1\right]^{-1}} % Pre-image
\newcommand{\eval}[3]{\left. #1\right\rvert_{#2 = #3}} % Evaluated at

\begin{document}
\fancyhead[L]{
    Combinatorics and Graphs I 
}
\fancyhead[R]{
    Lecture Notes
}
\tableofcontents

\chapter{Permutations and Combinations}
\section{Basic Counting Principles}
An important motivation to study combinatorics is to count the \textbf{number of ways} in which an event may occur. Intuitively, we have two approaches to count.

The first approach is to categorise the event into \textbf{non-overlapping cases}. This means that we break an event into mutually exclusive sub-events, after which we can count the number of ways for each sub-event to occur. The agregate of these counts is the total number of ways for the original event to occur.

Those familiar with basic set theory may consider $E$ to be the set containing all distinct ways for an event to occur. By breaking up the event, we essentially establish a \textbf{partition} of~$E$, so that the sum of cardinalities of all the elements in that partition equals the cardinality of $E$.

This motivates us to write the following principle using set notations.
\begin{thmbox}{Addition Principle (AP)}{AP}
    Let $k \in \N^+$ and let $A_1, A_2, \cdots, A_k$ be $k$ finite sets which are pairwise disjoint, i.e. $A_i \cap A_j = \varnothing$ whenever~$i \neq j$, then
   \begin{equation*}
        \abs{\bigcup_{i = 1}^k A_i} = \sum_{i = 1}^{k}\abs{A_i}.
   \end{equation*} 
   \tcblower
   \begin{proof}
        The case where $k = 1$ is trivial.

        Suppose that when $k = n$, we have
        \begin{equation*}
            \abs{\bigcup_{i = 1}^n A_i} = \sum_{i = 1}^{n}\abs{A_i}
        \end{equation*} 
        for any $n$ finite sets which are pairwise disjoint. Let $A_{n + 1}$ be an arbitrary finite set which is disjoint with any of the $A_i$'s from the $n$ sets. So we have:
        \begin{align*}
            \abs{\bigcup_{i = 1}^{n + 1} A_i} & = \abs{\left(\bigcup_{i = 1}^n A_i\right) \cup A_{n + 1}} \\
            & = \abs{\bigcup_{i = 1}^n A_i} + \abs{A_{n + 1}} - \abs{\left(\bigcup_{i = 1}^n A_i\right) \cap A_{n + 1}} \\
            & = \left(\sum_{i = 1}^{n}\abs{A_i}\right) + \abs{A_{n + 1}} - \abs{\varnothing} \\
            & = \sum_{i = 1}^{n + 1}\abs{A_i}.
        \end{align*}
        Therefore, the original statement holds for all $k \in \N^+$.
   \end{proof}
\end{thmbox}
\begin{notebox}
    \begin{remark}
        In more casual language, this means that if an event $E_k$ has $n_k$ distinct ways to occur, then there is $\sum_{i = 1}^{k}n_k$ ways for at least one of the events $E_1, E_2, \cdots, E_k$ to occur, provided that $E_i$ and $E_j$ can never occur concurrently whenever $i \neq j$.
    \end{remark}
\end{notebox}
Given an event $E$, the other approach to count the number of ways for it to occur is to break~$E$ up internally into \textbf{non-overlapping stages}.

With set notations, we can write the $i$-th stage for $E$ to occur as $e_i$, and so a way for $E$ to occur can be represented by an ordered tuple $(e_1, e_2, \cdots, e_k)$, where $k$ is the total number of stages to undergo for $E$ to occur.

Let $E_i$ denote the set of all distinct ways to undergo the $i$-th stage of $E$, then it is easy to see that $E$ is just the \textbf{Cartesian product} of all the $E_i$'s. Hence, we derive the following principle:
\begin{thmbox}{Multiplication Principle (MP)}{MP}
    Let $k \in \N^+$ and let $A_1, A_2, \cdots, A_k$ be $k$ pairwise disjoint finite sets, then
    \begin{equation*}
        \abs{\prod_{i = 1}^{k}A_i} = \prod_{i = 1}^{k}\abs{A_i}.
    \end{equation*}
    \tcblower
    \begin{proof}
        The case where $k = 1$ is trivial.

        Suppose that when $k = n$, we have
        \begin{equation*}
            \abs{\prod_{i = 1}^{n}A_i} = \prod_{i = 1}^{n}\abs{A_i}
        \end{equation*} 
        for any $n$ finite sets which are pairwise disjoint. Let $A_{n + 1}$ be an arbitrary finite set which is disjoint with any of the $A_i$'s from the $n$ sets. Take $a_i, a_j \in A_{n + 1}$. Note that for all $\mathbfit{a} \in \prod_{i = 1}^{n}A_i$, $(\mathbfit{a}, a_i) \neq (\mathbfit{a}, a_j)$ whenever $a_i \neq a_j$. This means that
        \begin{align*}
            \abs{\prod_{i = 1}^{n + 1}A_i} & = \abs{\prod_{i = 1}^{n}A_i \times A_{n + 1}} \\
            & = \abs{\prod_{i = 1}^{n}A_i}\abs{A_{n + 1}} \\
            & = \left(\prod_{i = 1}^{n}\abs{A_i}\right)\abs{A_{n + 1}} \\
            & = \prod_{i = 1}^{n + 1}\abs{A_i}
        \end{align*}
        Therefore, the original statement holds for all $k \in \N^+$.
    \end{proof}
\end{thmbox}
\begin{notebox}
    \begin{remark}
        In more casual language, this means that if an event $E$ requires $k$ stages to be undergone before it occurs and the $i$-th stage has $n_i$ ways to complete, then there is $\prod_{i = 1}^{k}n_k$ ways for $E$ to occur, provided that no two different stages complete concurrently.
    \end{remark}
\end{notebox}
Often times, it is not straight-forward to count directly due to the presence of restrictions. We shall consider the following:

Let $E$ be the set of all possible ways for an event to occur. Let $p$ be some predicate representing some restriction and let $E(p)$ denote the set of all possible ways for the event to occur while $p$ holds. Note that:
\begin{displaymath}
    E(p) \cup E(\neg p) = E \quad \textrm{and} \quad E(p) \cap E(\neg p) = \varnothing,
\end{displaymath}
i.e. $\left\{E(p), E(\neg p)\right\}$ is a partition of $E$. Therefore, to count the number of ways for the event to occur while $p$ holds, it suffices to compute $E(\neg p)$, i.e. find the number of ways for the event to occur while $p$ does not hold.
\begin{thmbox}{Principle of Complementation}{PC}
    Let $U$ be a set and let $E \subseteq U$, then 
    \begin{equation*}
        \abs{E} = \abs{U} - \abs{U - E}.
    \end{equation*}
\end{thmbox}
\begin{notebox}
    \begin{remark}
        It may also help to think the Principle of Complementation as an inverse of the Addition Principle, where
        \begin{displaymath}
            E = \bigcup_{i = 1}^n E_i
        \end{displaymath}
        is the total number of ways for an event to occur and $E_p$ is the number of ways for the event to occur with restriction $p$.
    \end{remark}
\end{notebox}
In some cases, it is difficult to count the objects directly. However, note that the events for which we are counting are just sets, so we can treat ``number of occurrences'' of an event as the \textbf{cardinality} of a set. Therefore, we have the following principles:
\begin{thmbox}{Injection Principle}{injPrinciple}
    Let $A$, $B$ be finite sets. If there exists an injection
    \begin{displaymath}
        f \colon A \hookrightarrow B,
    \end{displaymath}
    then $\abs{A} \leq \abs{B}$.
\end{thmbox}
\begin{thmbox}{Bijection Principle}{bijPrinciple}
    Let $A$, $B$ be finite sets. If there exists a bijection
    \begin{displaymath}
        f \colon A \to B,
    \end{displaymath}
    then $\abs{A} = \abs{B}$.
\end{thmbox}
\section{Permutations}
A fundamental problem in combinatorics is described as follows: given a set $S$, how many ways are there to arrange $r$ elements in $S$, i.e. how many \textbf{distinct sequences} can be formed using the elements in $S$ without repetition? The process of selecting elements from $S$ and arranging them as a sequence is known as \textbf{permutation}.

Note that forming a sequence using $r$ elements from a set $S$ is an event consisting of $r$ stages, as we need to select an element for each of the $r$ terms of the sequence. Suppose $S$ has $n$ elements. For the first term of the sequence, we can choose any of the elements in $S$, so there is $n$ ways to do it. For the second term, since we cannot repeat the elements, we are left with $n - 1$ choices. 

Continue choosing elements in this way, we realise that if we choose the terms sequentially, when we reach the $k$-th term we will be left with $n - k + 1$ options as the previous~$(k - 1)$ terms have taken away $(k - 1)$ elements. By Theorem \ref{thm:MP}, we know that the number of sequences which can be formed is given by $\prod_{i = 1}^{r}(n - r + i)$.
\begin{dfnbox}{Permutations}{permutations}
    Let $A$ be a finite set such that $\abs{A} = n$, an $r$-permutation of $A$ is a way to arrange $r$ elements of $A$, denoted as $P^n_r$ and given by
    \begin{equation*}
        P^n_r = \prod_{i = 1}^{r}(n - r + i) = \frac{n!}{(n - r)!}.
    \end{equation*}
\end{dfnbox}
With some algebraic manipulations, it is easy to derive the following formula, which we, however, will prove in a combinatorial manner.
\begin{thmbox}{}{permutationId}
    Let $n, r \in \N$ with $r \leq n$, then $P^{n + 1}_r = P^n_r + rP^n_{r - 1}$.
    \tcblower
    \begin{proof}
        Let $S = \left\{x \in \N^+ \colon x \leq n + 1\right\}$ represent $(n + 1)$ distinct objects. Consider a permutation of $S$:
        \\\\
        If $n + 1$ is not inside the permutation, this is equivalent to an $r$-permutation of~$S - \{n + 1\}$, so there are $P^n_r$ such permutations.
        \\\\
    If $n + 1$ is inside the permutation, it means we need to first find an $(r - 1)$-permuation of $S - \{n + 1\}$, which has $P^n_{r - 1}$ ways to do. After that, we need to insert~$n + 1$ into each of these $(r - 1)$-permutations. Note that for each of such permutations, there are $r$ positions into which we can place $n + 1$. Therefore, the total number of $r$-permuations of $S$ derived in this manner is $rP^n_{r - 1}$.
        \\\\
        Therefore, there are $P^n_{r} + rP^n_{r - 1}$ $r$-permutations of $S$, i.e. $P^{n + 1}_r = P^n_r + rP^n_{r - 1}$. 
    \end{proof}
\end{thmbox}
\subsection{Circular Permutations}
Consider arranging $n$ distinct objects around a circle. If the slots around the circle are uniquely labelled, this is exactly the same as permutations along a straight line.

However, if the slots are identical, i.e. we are arranging $n$ distinct objects around a circle with identical slots, only the \textbf{relative positions} of the objects matter.

Let $\mathbfit{x}_i$ be an arbitrary straight-line permutations of the $n$ objects and let $\mathbfit{y}_i$ be the corresponding circular permutation of the $n$ objects.

Note that if we translate every element in $\mathbfit{x}_i$ by $k$ positions, this will result in a different straight-line permutation $\mathbfit{x}_j$ but does not change the corresponding circular permutation because the relative positions of the objects remain unchanged.

Notice that $k$ can take the values $0, 1, 2, \cdots, n - 1$, so for the same set of $n$ distinct objects, every circular permutation is mapped to $n$ straight-line permutations.
\begin{dfnbox}{Circular Permutations}{circPermutation}
    Let $A$ be a finite set such that $\abs{A} = n$, a circular $r$ permutation of $A$ is a way to arrange~$r$ elements of $A$ around a circular locus, denoted as $Q^n_r$ and given by
    \begin{equation*}
        Q^n_r = \frac{P^n_r}{r} = \frac{n!}{r(n - r)!}.
    \end{equation*}
\end{dfnbox}
\subsection{Permutations with Idential Objects}
\begin{thmbox}{Generalised Formula for Permutations}{genPnr}
    Let $k \in \N^+$ and let $A_1, A_2, \cdots, A_k$ be $k$ distinct objects, where $A_i$ occurs $n_i > 0$ times for~$i = 1, 2, \cdots, k$, then the number of permutations for these $k$ objects are given by
    \begin{equation*}
        \frac{\left(\sum_{i = 1}^{k}n_i\right)!}{\prod_{i = 1}^{k}\left(n_i!\right)}.
    \end{equation*}
\end{thmbox}
\section{Combinations}
Beside permutations, there are also occasions where we only care about which elements from a particular set are selected instead of the order of selection.

Note that if we want to find a selection of $r$ elements from a set $A$ where the order of selected elements does not matter, it is equivalent to finding a subset of $A$ containing $r$ elements. This motivates us to give the following definition:
\begin{dfnbox}{Combinations}{combinations}
    Let $A$ be a finite set such that $\abs{A} = n$, an $r$-combination of $A$ is a set $B \subseteq A$ with~$\abs{B} = r$. The number of combinations of $A$ is given by
    \begin{equation*}
        C^n_r = \frac{P^n_r}{P^r_r} = \frac{n!}{r!(n - r)!} = \begin{pmatrix}
            n \\
            r
        \end{pmatrix}.
    \end{equation*}
\end{dfnbox}
\begin{notebox}
    \begin{remark}
        Two obvious results:
        \begin{enumerate}
            \item If $r > n$ or $r < 0$, $C^n_r = 0$;
            \item $C^n_r = C^n_{n - r}$ (By Theorem \ref{thm:PC}).
        \end{enumerate}
    \end{remark}
\end{notebox}
Similar to permutations, we have the following important identity:
\begin{thmbox}{Pascal's Triangle}{pascalTri}
    Let $n$ be an integer with $n \geq 2$ and let $r$ be an integer with $0 \leq r \leq n$, then
    \begin{equation*}
        C^{n + 1}_r = C^{n}_{r - 1} + C^{n}_r.
    \end{equation*}
    \tcblower
    \begin{proof}
        Let $S = \left\{x \in \N^+ \colon x \leq n + 1\right\}$ represent $(n + 1)$ distinct objects. Consider an $r$-combination $T$ of $S$:
        \\\\
        If $n + 1 \notin T$, this is equivalent to an $r$-combination of $S - \{n + 1\}$, so there are $C^n_r$ such permutations.
        \\\\
        If $n + 1 \in T$, it suffices to find an $(r - 1)$-combination of $S - \{n + 1\}$, which has $C^n_{r - 1}$ ways to do.
        \\\\
        Therefore, there are $C^n_{r} + C^n_{r - 1}$ $r$-combinations of $S$, i.e. $C^{n + 1}_r = C^n_r + C^n_{r - 1}$. 
    \end{proof}
\end{thmbox}
\subsection{Counting Subsets}
A useful application of combinations, derived directly from the definition, is to count the number of subsets for a given set which is finite. In other words, given a set $A$ with $\abs{A} = n \in \N$, we wish to find a general formula for $\abs{\mathcal{P}(A)}$.

Let $A_i$ be the set of all subsets of $A$ whose cardinality is $i$, then clearly
\begin{equation*}
    \abs{\mathcal{P}(A)} = \sum_{i = 0}^{n}\abs{A_i} = \sum_{i = 0}^{n}C^n_i.
\end{equation*}
We can expand the above expression algebraically and realise that it simpifies to $2^n$. However, in a combinatorial perspective, we are able to prove this result in a more succint manner:
\begin{thmbox}{General Formula for $\abs{\mathcal{P}(A)}$}{cardPowerset}
    Let $A$ be a finite set. If $\abs{A} = n$, then $\abs{\mathcal{P}(A)} = 2^n$.
    \tcblower
    \begin{proof}
        Let $S$ be an arbitrary subset of $A$. Consider an arbitrary element $a \in A$, then either $a \in S$ or $a \notin S$. 
        \\\\
        Let $a_i \in A$ for $i = 1, 2, \cdots, n$. For all $S \in \mathcal{P}(A)$, We replace $a_i$ by $1$ if $a_i \in S$, and by $0$ otherwise. Let $B$ be the set of all binary sequences of length $n$. It is clear that there exists a bijection between $\mathcal{P}(A)$ and $B$, and so $\abs{\mathcal{P}(A)} = \abs{B}$.
        \\\\
        For each binary sequence of length $n$, each of its digits is either $0$ or $1$. By Theorem \ref{thm:MP}, this means that there are in total $2^n$ such binary sequences. Therefore,
        \begin{equation*}
            \abs{\mathcal{P}(A)} = \abs{B} = 2^n.
        \end{equation*}
    \end{proof}
\end{thmbox}

\section{Distribution Problems}
Another problem in which we are interested is to \textbf{distribute} the objects from a collection into a finite number of sub-collections. Specifically, we consider the number of ways to
\begin{enumerate}
    \item distribute $r$ distinct objects into $n$ identical collections;
    \item distribute $r$ distinct objects into $n$ distinct collections;
    \item distribute $r$ identical objects into $n$ identical collections;
    \item distribute $r$ identical objects into $n$ distinct collections.
\end{enumerate}
These $4$ basic models of distribution problems give rise to many variations. One important tool to solve these problems is the \textit{Stirling Numbers}.
\subsection{Stirling Numbers}
\begin{dfnbox}{Stirling Numbers of the First Kind}{stirling1}
    Let $r, n \in \N$ such that $0 \leq n \leq r$, then the {\color{red} \textbf{Stirling Number of the First Kind}}, $s(r, n)$, is the number of ways to arrange $r$ {\color{red} \textbf{distinct}} onjects around $n$ {\color{red} \textbf{identical}} circles such that no circle is empty.
\end{dfnbox}
\begin{notebox}
    \begin{remark}
        Some obvious results:
        \begin{enumerate}
            \item $s(r, 0) = 0$ if $r \geq 1$.
            \item $s(r, r) = 1$ if $r \geq 0$.
            \item $s(r, 1) = (r - 1)!$ if $r \geq 2$.
            \item $s(r, r - 1) = C^r_2$ if $r \geq 2$.
        \end{enumerate}
    \end{remark}
\end{notebox}
One thing to take note of is that there is no general algebraic formula for $s(r, n)$. Instead, all Stirling Numbers of the First Kind follow a recurrence relation in $2$ parameters.
\begin{thmbox}{A Recurrence Relation for $s(r, n)$}{recurrence1}
    For $r, n \in \N^+$ and $r \leq n$, we have
    \begin{equation*}
        s(r, n) = s(r - 1, n - 1) + (r - 1)s(r - 1, n).
    \end{equation*}
    \tcblower   
    \begin{proof}
        Consider the set
        \begin{displaymath}
            \left\{x_1, x_2, \cdots, x_r\right\}
        \end{displaymath}
        to be the $r$ distinct objects. We consider two cases.
        \\\\
        If $x_r$ is distributed to a circle such that it is the only objects around that circle, it suffices to find the number of ways to arrange the rest $(r - 1)$ distinct objects around the rest $(n - 1)$ identical circles, which there are $s(r - 1, n - 1)$ ways to do.
        \\\\
        If $x_r$ is adjacent to some other object, we can first arrange the rest $(r - 1)$ distinct objects around the $n$ identical circles, which there are $s(r - 1, n)$ ways to do. After that, we can choose any one of the $(r - 1)$ spaces between two adjacent objects to slot in $x_r$. Therefore, there are $(r - 1)s(r - 1, n)$ ways to distribute the objects.
        \\\\
        By Theorem \ref{thm:AP}, the total number of distributions is 
        \begin{equation*}
            s(r, n) = s(r - 1, n - 1) + (r - 1)s(r - 1, n).
        \end{equation*}
    \end{proof}
\end{thmbox}
\end{document}